<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Index mastermind</title>
    <style>
        /* Agrega estilos CSS según sea necesario */
        .containsMasterArrayHidden {
            background-color: grey;
        }
    </style>
</head>

<body onload="init()">
    <script>
        const colorsArray = ['white', 'green', 'red', 'blue', 'pink', 'yellow', 'orange', 'cyan'];
        const masterArray = [];
        const userArray = [];
        const colorsResultArray = [];
        const MAX_ATTEMPTS = 10;
        const MAX_COMBINATION_COLORS = 4;
        let attempts = 0;

        function getRandomMaster() {
            for (let i = 1; i <= MAX_COMBINATION_COLORS; i++) {
                masterArray.push(colorsArray[Math.floor(Math.random() * colorsArray.length)]);
            }
            console.log("ARRAY DE LA MASTER: " + masterArray);
        }

        function getRandomUser() {
            userArray.length = 0; // Reinicia el array del usuario
            for (let i = 1; i <= MAX_COMBINATION_COLORS; i++) {
                userArray.push(colorsArray[Math.floor(Math.random() * colorsArray.length)]);
            }
            console.log("ARRAY DEL USUARIO: " + userArray);
            updateCurrentUserArray(userArray);
        }

        function makeMasterArray(masterArray) {
            let containerDiv = document.createElement("div");
            containerDiv.className = "containsMasterArrayHidden"; // Inicialmente oculto
            for (let i = 0; i < masterArray.length; i++) {
                let div = document.createElement("div");
                div.className = "masterBoxes";
                div.innerHTML = masterArray[i];
                containerDiv.appendChild(div);
                containerDiv.style.display = "flex";
                div.style.backgroundColor = "grey"; // Color gris inicial
                div.style.width = "70px";
                div.style.height = "70px";
                div.style.margin = "10px";
            }
            document.body.appendChild(containerDiv);
        }

        function makeVisibleMasterArray() {
            let hiddenMasterArray = document.querySelector(".containsMasterArrayHidden");
            if (hiddenMasterArray) {
                hiddenMasterArray.style.backgroundColor = "transparent"; // Mostrar el array de la master
            }
        }

        function makeUserArray(userArray) {
            let containerUser = document.createElement("div");
            containerUser.className = "containsUserArray";
            for (let i = 0; i < userArray.length; i++) {
                let div = document.createElement("div");
                div.className = "userBoxes";
                div.innerHTML = userArray[i];
                containerUser.appendChild(div);
                containerUser.style.display = "flex";
                div.style.backgroundColor = userArray[i];
                div.style.width = "70px";
                div.style.height = "70px";
                div.style.margin = "10px";
            }
            document.body.appendChild(containerUser);
        }

        function makeColoursArray(colorsArray) {
            let containerDiv = document.createElement("div");
            containerDiv.className = "containsColoursArray";
            containerDiv.style.display = "flex";

            for (let i = 0; i < colorsArray.length; i++) {
                let div = document.createElement("div");
                div.className = "colorBottoms";
                div.innerHTML = colorsArray[i];
                div.style.width = "70px";
                div.style.height = "70px";
                div.style.backgroundColor = colorsArray[i];
                div.style.margin = "10px";

                div.onclick = function () {
                    addUserColor(colorsArray[i]);
                };

                containerDiv.appendChild(div);
            }
            document.body.appendChild(containerDiv);
        }

        function addUserColor(color) {
            if (userArray.length < MAX_COMBINATION_COLORS) {
                userArray.push(color);
                updateCurrentUserArray(userArray);
            }
        }

        function updateCurrentUserArray(userArray) {
            let existingUserContainer = document.querySelector(".containsUserArray");
            if (existingUserContainer) {
                document.body.removeChild(existingUserContainer);
            }
            makeUserArray(userArray);
        }

        function compareTwoArrays() {
            colorsResultArray.length = 0; // Reinicia el array de resultados
            console.log("entra en compare");

            let allColorsMatch = true;

            for (let i = 0; i < masterArray.length; i++) {
                if (masterArray[i] === userArray[i]) {
                    colorsResultArray.push("black");
                } else if (userArray.includes(masterArray[i])) {
                    colorsResultArray.push("grey");
                    allColorsMatch = false;
                } else {
                    colorsResultArray.push("white");
                    allColorsMatch = false;
                }
            }

            if (allColorsMatch) {
                colorsResultArray.fill("black");
            }

            makeResultArray(colorsResultArray);

            attempts++;
            document.getElementById("attemptsCounter").innerText = attempts;

            if (attempts >= MAX_ATTEMPTS) {
                makeVisibleMasterArray();
            }
        }

        function makeResultArray(colorsResultArray) {
            let containerResult = document.createElement("div");
            containerResult.className = "containsResultArray";
            containerResult.style.backgroundColor = "Violet";
            for (let i = 0; i < MAX_COMBINATION_COLORS; i++) {
                let div = document.createElement("div");
                div.className = "resultBoxes";
                div.innerHTML = colorsResultArray[i];
                containerResult.appendChild(div);
                containerResult.style.display = "flex";
                div.style.backgroundColor = colorsResultArray[i];
                div.style.width = "70px";
                div.style.height = "70px";
                div.style.margin = "10px";
            }
            document.body.appendChild(containerResult);
        }

        function init() {
            getRandomMaster();
            makeMasterArray(masterArray);
            makeColoursArray(colorsArray);
        }
    </script>
    <h1>Mastermind</h1>
    <article class="containsFirstPartOfGame">
        <div class="containsMasterArray">MASTER ARRAY</div>
        <div class="containsColoursArray">
            <h2>Pulsa la combinación de 4 colores</h2>
            ARRAY DE COLORES
            <button class="checkButton" onclick="compareTwoArrays()">Comprobar</button>
            <button class="generateUserArrayButton" onclick="getRandomUser()">Generar Combinación Usuario</button>
        </div>
    </article>
    <article class="checkGame">
        <div>
            <p class="mensajeIntentos">Intentos realizados: <span id="attemptsCounter">0</span></p>
            <div class="containsResults">
                <div class="options"></div>
                Contiene array de colores del usuario
                <div class="results"></div>
                Contiene array con colores black white y grey
            </div>
        </div>
    </article>
    <div class="containsUserTries"></div>
</body>

</html>
